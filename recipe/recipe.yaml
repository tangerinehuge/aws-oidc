context:
  version: "0.35.1" # x-release-please-version

package:
  name: aws-oidc
  version: ${{ version }}

source:
  - if: linux and x86_64
    then:
      url: https://github.com/chanzuckerberg/aws-oidc/releases/download/v${{ version }}/aws-oidc_${{ version }}_linux_amd64.tar.gz
  - if: linux and aarch64
    then:
      url: https://github.com/chanzuckerberg/aws-oidc/releases/download/v${{ version }}/aws-oidc_${{ version }}_linux_arm64.tar.gz
  - if: osx and arm64
    then:
      url: https://github.com/chanzuckerberg/aws-oidc/releases/download/v${{ version }}/aws-oidc_${{ version }}_darwin_arm64.tar.gz
  - if: osx and x86_64
    then:
      url: https://github.com/chanzuckerberg/aws-oidc/releases/download/v${{ version }}/aws-oidc_${{ version }}_darwin_amd64.tar.gz

build:
  number: 0
  script:
    - if: unix
      then:
        - mkdir -p $PREFIX/bin
        - install -m 755 aws-oidc $PREFIX/bin/aws-oidc

tests:
  - script:
      - aws-oidc version
